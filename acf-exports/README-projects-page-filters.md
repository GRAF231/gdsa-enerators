# Настройка фильтров страницы "Выполненные проекты"

## Описание

Теперь вы можете полностью управлять фильтрами на странице проектов через админ-панель WordPress. Вы можете:
- Включать/выключать целые категории фильтров
- Скрывать отдельные опции в каждом фильтре
- Добавлять новые опции
- Изменять названия опций

## Импорт полей ACF

1. Войдите в админ-панель WordPress
2. Перейдите в **Custom Fields → Field Groups** (или **ACF → Field Groups**)
3. Нажмите на кнопку **"Import Field Groups"**
4. Выберите файл `acf-exports/group_projects-page-fields.json`
5. Нажмите **"Import"**

После импорта поля будут автоматически привязаны к шаблону `template-projects.php`.

## Использование

### 1. Доступ к настройкам фильтров

1. Откройте страницу **"Выполненные проекты"** в админке WordPress
2. Убедитесь, что выбран шаблон **"Выполненные проекты"**
3. Прокрутите страницу вниз до блока **"Projects Page Fields"**
4. Откройте группу **"Настройки фильтров"**

### 2. Включение/выключение категорий фильтров

В группе **"Настройки фильтров"** вы найдете 4 переключателя:

- **"Показывать фильтр 'Диапазон мощности'"** - включить/выключить фильтр по мощности
- **"Показывать фильтр 'Отрасль применения'"** - включить/выключить фильтр по отрасли
- **"Показывать фильтр 'Город'"** - включить/выключить фильтр по городу
- **"Показывать фильтр 'Год'"** - включить/выключить фильтр по году

### 3. Настройка опций каждого фильтра

Для каждого включенного фильтра доступен repeater с опциями:

#### Диапазон мощности (`power_ranges`)
- **Значение (ключ)** - ключ для фильтрации (например: `16-40`, `40-80`)
- **Название** - текст на кнопке (например: `16-40 кВт`)
- **Показывать** - включить/выключить отображение этой опции

#### Отрасль применения (`industries`)
- **Значение (ключ)** - ключ для фильтрации (например: `industrial`, `commercial`)
- **Название** - текст на кнопке (например: `Промышленность`)
- **Показывать** - включить/выключить отображение этой опции

#### Город (`cities`)
- **Значение (ключ)** - ключ для фильтрации (например: `moscow`, `spb`)
- **Название** - текст на кнопке (например: `Москва`)
- **Показывать** - включить/выключить отображение этой опции

#### Год (`years`)
- **Значение (ключ)** - значение года (например: `2025`, `2024`)
- **Название** - текст на кнопке (обычно совпадает со значением)
- **Показывать** - включить/выключить отображение этой опции

### 4. Добавление новых опций

1. Найдите нужный repeater (например, "Опции фильтра 'Диапазон мощности'")
2. Нажмите **"Добавить диапазон"** (или соответствующую кнопку)
3. Заполните поля:
   - **Значение (ключ)** - уникальный ключ для фильтрации
   - **Название** - текст, который будет отображаться на кнопке
   - **Показывать** - включите, чтобы опция отображалась
4. Сохраните страницу

### 5. Скрытие опций

1. Найдите опцию в repeater
2. Переключите поле **"Показывать"** в положение **"Нет"**
3. Сохраните страницу

Опция исчезнет из фильтра на сайте, но данные сохранятся.

### 6. Удаление опций

1. Найдите опцию в repeater
2. Нажмите **"Удалить"** (иконка корзины)
3. Сохраните страницу

## Важно

### Значения ключей

**Ключи должны совпадать с данными в проектах:**

- **Диапазоны мощности** должны совпадать с диапазонами, используемыми в ACF поле `power_range` проектов
- **Отрасли** должны совпадать с значениями из ACF поля `industry` проектов
- **Города** должны совпадать с значениями из ACF поля `city` проектов
- **Годы** должны совпадать с значениями из ACF поля `year` проектов

### Fallback на дефолтные значения

Если настройки фильтров не заполнены в ACF, будут использоваться дефолтные значения:
- Все фильтры включены
- Все стандартные опции отображаются

### Кнопка "Все"

Кнопка **"Все"** всегда отображается в каждом фильтре и не может быть скрыта через админку.

## Примеры использования

### Скрыть диапазон "6000-12000 кВт"

1. Откройте **"Опции фильтра 'Диапазон мощности'"**
2. Найдите запись с значением `6000-12000`
3. Переключите **"Показывать"** в **"Нет"**
4. Сохраните страницу

### Выключить фильтр "Год"

1. Найдите переключатель **"Показывать фильтр 'Год'"**
2. Переключите в положение **"Выключено"**
3. Сохраните страницу

Фильтр исчезнет из интерфейса.

### Добавить новый город

1. Откройте **"Опции фильтра 'Город'"**
2. Нажмите **"Добавить город"**
3. Заполните:
   - **Значение (ключ)**: `novosibirsk`
   - **Название**: `Новосибирск`
   - **Показывать**: `Да`
4. Сохраните страницу

## Техническая информация

- Функция получения настроек: `dsa_get_projects_filters($page_id)`
- Дефолтные значения определены в функции `dsa_get_projects_filters()` в `functions.php`
- Шаблон использует динамический вывод фильтров на основе ACF данных
- Все данные экранируются через `esc_html()` и `esc_attr()` для безопасности

